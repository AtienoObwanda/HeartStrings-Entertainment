import React, { useState } from 'react';

const AddPlayForm = () => {
  const [formData, setFormData] = useState({
    title: '',
    synopsis: '',
    poster: null,
    infotrailer: null,
    theater: '',
    play_cast_list: [],
    play_offers_list: [],
  });

  const handleInputChange = (e) => {
    const { name, value } = e.target;
    setFormData({
      ...formData,
      [name]: value,
    });
  };

  const handlePosterChange = (e) => {
    setFormData({
      ...formData,
      poster: e.target.files[0],
    });
  };

  const handleTrailerChange = (e) => {
    setFormData({
      ...formData,
      infotrailer: e.target.files[0],
    });
  };

  const handleCastChange = (e, index) => {
    const newCastList = [...formData.play_cast_list];
    newCastList[index][e.target.name] = e.target.value;
    setFormData({
      ...formData,
      play_cast_list: newCastList,
    });
  };

  const handleOffersChange = (e, index) => {
    const newOffersList = [...formData.play_offers_list];
    newOffersList[index][e.target.name] = e.target.value;
    setFormData({
      ...formData,
      play_offers_list: newOffersList,
    });
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    const apiUrl = 'http://127.0.0.1:8000/api/plays/';
    const formDataToSend = new FormData();

    for (const key in formData) {
      if (key === 'play_cast_list' || key === 'play_offers_list') {
        formDataToSend.append(key, JSON.stringify(formData[key]));
      } else {
        formDataToSend.append(key, formData[key]);
      }
    }

    const response = await fetch(apiUrl, {
      method: 'POST',
      body: formDataToSend,
    });

    const responseBody = await response.json();
    console.log(responseBody);
  };

  return (
    <div>
      <h2>Add Play</h2>
      <form onSubmit={handleSubmit}>
        {/* Add input fields and handlers */}
      </form>
    </div>
  );
};

export default AddPlayForm;
